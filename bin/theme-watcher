#!/bin/bash

# Watch for macOS appearance changes and reload tmux theme
# This script monitors the macOS appearance setting and reloads tmux when it changes

get_appearance() {
  defaults read -g AppleInterfaceStyle 2>/dev/null || echo "Light"
}

current_appearance=$(get_appearance)

while true; do
  sleep 3
  new_appearance=$(get_appearance)
  
  if [ "$current_appearance" != "$new_appearance" ]; then
    echo "$(date): Appearance changed from $current_appearance to $new_appearance"
    current_appearance=$new_appearance
    
    # Reload tmux config for all running tmux sessions
    if command -v tmux &> /dev/null && tmux list-sessions &> /dev/null; then
      tmux source-file ~/.tmux.conf
      echo "$(date): Tmux theme reloaded"
    fi
  fi
done
